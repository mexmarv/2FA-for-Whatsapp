# 2FA لـ Whatsapp/Chatbots باستخدام Chatfuel (إذا لزم الأمر) والإجابات المعروفة من client_id

يحتوي هذا المستودع على كود Python لتنفيذ المصادقة الثنائية (2FA) باستخدام إجابة معروفة (تاريخ الميلاد) منclient_id لـ WhatsApp/Chat Bots. يتيح لك هذا المشروع إنشاء صفحات ويب ديناميكية تحتوي على أسئلة ليجيب عليها المستخدمون، والتحقق من صحة إجاباتهم، وإعادة توجيههم إلى رابط WhatsApp العميق لمزيد من التفاعل، أثناء الرد على وقود الدردشة للتحقق من صحة المستخدم للتدفق أو الحظر المطلوب. يمكنك التعلم من هذا المستودع والتكامل وفقًا لذلك.

[![dependency - Python](https://img.shields.io/badge/dependency-Python-blue)](https://pypi.org/project/Python)![GitHub language count](https://img.shields.io/github/languages/count/mexmarv/2FA-for-Whatsapp)![GitHub commit activity](https://img.shields.io/github/commit-activity/y/mexmarv/2FA-for-Whatsapp)[![License](https://img.shields.io/badge/License-MIT-blue)](#license)[![issues - 2FA-for-Whatsapp](https://img.shields.io/github/issues/mexmarv/2FA-for-Whatsapp)](https://github.com/mexmarv/2FA-for-Whatsapp/issues)

## إعدادات

قبل تشغيل البرنامج النصي، تحتاج إلى تكوين المتغيرات التالية:

-   `HOST`: مضيف الخادم (استبدله بالخادم الذي تستضيفه).
-   `URL_SUFFIX`: عنوان URL يكفي للوصول إلى الخادم (على سبيل المثال، "http&#x3A;//" أو "https&#x3A;//"، ولكن اقترح https نظرًا لأن Whatsapp وGoogle يعيدان التوجيه إلى الأمان).
-   `expiration`: الوقت بالثواني لحذف الصفحات التي تم إنشاؤها ديناميكيًا.
-   `api_port`: المنفذ لخادم API. هنا تتلقى Client_id والسؤال الذي سيتم تقديمه.
-   `web_port`: منفذ خادم الويب الذي ستتمكن من إعادة توجيه whatsapp/الدردشة للرد على سؤال معروف.

## التبعيات

تأكد من تثبيت Python على نظامك. يمكنك تثبيت مكتبات Python المطلوبة باستخدام pip3:

    pip3 install fastapi uvicorn waitress flask requests sqlite3

أو

    pip install -r requirements.txt

## تشغيل البرنامج النصي

لتشغيل البرنامج النصي، قم بتنفيذ الأمر التالي:

    python3 mnMFA.py

سيبدأ البرنامج النصي كلاً من سلاسل واجهة برمجة التطبيقات وخادم الويب للتعامل مع إنشاء الصفحات الديناميكية والتحقق من صحتها.

## تركيب عامل الميناء

وبدلاً من ذلك، يمكنك تشغيل البرنامج النصي داخل حاوية Docker. اتبع الخطوات التالية:

1.  بناء صورة عامل الميناء:

        docker build -t mn_mfa .

2.  قم بتشغيل حاوية Docker:

        docker run -p 443:443 -p 8000:8000 mn_mfa

سيتم الوصول إلى الخادم من خلال المنفذين 443 و8000 على مضيفك المحلي.

## HTTPS (مطلوب)

`Generate Self-Signed Certificates:`

يمكنك استخدام OpenSSL لإنشاء شهادات موقعة ذاتيًا. قم بتشغيل الأوامر التالية لإنشاء مفتاح خاص وشهادة موقعة ذاتيًا:

    openssl req -x509 -newkey rsa:4096 -nodes -out cert.pem -keyout key.pem -days 365

سيقوم هذا الأمر بإنشاء شهادة (cert.pem) ومفتاح خاص (key.pem) صالحين لمدة 365 يومًا. اتبع المطالبات لملء التفاصيل مثل البلد والمنظمة وما إلى ذلك.

يمكنك دائمًا الحصول على SSL مجاني لمدة 90 يومًا من العديد من البائعين، ولكن يجب تثبيت كل من المفتاح والشهادة.

## الاستخدام

بمجرد تشغيل البرنامج النصي، يمكنك الوصول إلى الصفحات التي تم إنشاؤها ديناميكيًا من خلال زيارة عناوين URL التي توفرها واجهة برمجة التطبيقات. يمكن للمستخدمين الإجابة على الإجابات المتعددة من خلال مولدين عشوائيين، وسيتم التحقق من صحة إجاباتهم، وإرسالها مرة أخرى إلى Chatfuel، وإعادة توجيهها إلى رابط WhatsApp العميق لاتخاذ مزيد من الإجراءات أثناء استجابة برنامج الدردشة الآلي الخاص بك.

أيضًا، لكل إجابة ناجحة، يتم حفظ الطابع الزمني وعنوان IP مع البيانات الأخرى في ´logs.db´، والتي يمكنك استخدامها للمساعدة إذا ذكر المستخدم أنه لم يقم بالمعاملة، فلديك معلومات أجاب عنها بشكل صحيح IP وبعض البيانات الإضافية. عدم التنصل من بعض القوانين، قاعدة البيانات هذه تساعد.

## ملحوظات:

نظرًا لعدم تمكن Whatsapp من طرح أسئلة معينة على MFA والقدرة على المصادقة مع الأنظمة، فإن حل MFA هذا صالح باعتباره MFA طالما يمكنك:

1.  قم بإنشاء سير عمل في chatfuel للتحقق من صحة المستخدم لمعاملات معينة. تم إرفاق مثال لسير العمل.
    <center><img src="/chatfuel.png"/></center>
2.  تعد قراءة التعليمات البرمجية أمرًا سهلاً، ويمكنك التكامل مرة أخرى مع أي واجهة برمجة تطبيقات خارجية للاستفادة من الإجابات والمعاملات. لقد قمت بإنشاء مخطط النظام البسيط هذا لفهمه (بفضل AI/GPT للمساعدة من مدخلاتي).
    <center><img src="/2FASystemDiagram.svg"/></center>
3.  لا تقم بإرجاع الإجابات من خلال قناة الدردشة، فهذا يتعارض مع غرض المصادقة الثنائية.
4.  أضفت`loadtest.py`والتي من أجل المتعة يمكنك تحميل الاختبار مع أكبر عدد من الطلبات والمواضيع لاختبار Docker أو بيئة الإنتاج الخاصة بك. لقد قمت بتعطيل التحقق من شهادة SSL لأن هذا يستغرق وقتًا طويلاً للتحقق من صحته. بعض النتائج المثيرة للاهتمام في مثيل Docker لوحدة المعالجة المركزية (CPU) وذاكرة الوصول العشوائي (RAM) سعة 8 جيجابايت والذي يعمل على تشغيل أحدث إصدار من Ubuntu في عامل الإرساء:


    10,000 tries with 1000 threads. Running on Docker, no certificate checking.
    Total time taken: 6.910074949264526 seconds
    Total successful requests: 10,000
    Total errors: 0
    Total requests: 10,000
    Transactions per second (TPS): 204.7162306258972

يتمتع!
مارفن نامياس

## رخصة

صدر تحت[مع](/LICENSE)بواسطة[@mexmarv](https://github.com/mexmarv).
